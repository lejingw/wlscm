#set($jsfiles = ["$!StringUtil.getContextPath()/dwr/interface/DisplayStandardDwr.js",
	"$StringUtil.getContextPath()/js/display/displayStandard_list.js?t=201211281640"])

<form id="frm" action="displayStandard.vm" method="post">
    <input type='hidden' id='user_action' name='user_action' value=''/>
    <table class="title">
    	<tr><td>畅销款铺货标准</td></tr>
    </table>
    <table class="control">
    	<tr>
			<td>
				<input type='button' value='修改' class='btn' onclick="editBill()" $RightUtil.able($session, '08091201','1')>
				<input type='button' value='导出所有行' class='btn' id='exportToExcel' onclick="exportListToExcel()" $RightUtil.able($session, '08091201','2')>
				<input type='button' value='查询' class='btn' id='btnQueryShow' >
			</td>
		</tr>
    </table>
	<div class="scroll">
        <table class='list'>
        	<thead>
    			<tr>
                    <th width='45px'><input type='checkbox' id='chkall'/></th>
					<th width='120px'>类别名称</th>
            		<th width='90px'>创建人</th>
            		<th width='120px'>创建时间</th>
            		<th width='90px'>修改人</th>
            		<th width='120px'>修改时间</th>
            		<th width='90px'>状态</th>
                </tr>
            </thead>
            <tbody id="tbl">
    		#foreach($item in $form.pager.pageData)
    			<tr>
    				<td><input type='checkbox' name='chk' value='$!{item.headid}'/>
						<input type='hidden' name='hd_orgtypeName' value="$!item.orgtypeName"/>
						$velocityCounter
					</td>
    				<td><a href='javascript:showEidtDialog($velocityCounter - 1);'>$!item.orgtypeName</a></td>
    				<td>$!BdCommon.getUserName($!item.createId)</td>
    				<td>$!item.createDate</td>
    				<td>$!BdCommon.getUserName($!item.updateId)</td>
    				<td>$!item.updateDate</td>
    				<td>$!DictUtil.getValue('status', $!item.status)</td>
    			</tr>
    		#end
        	</tbody>
        </table>
	</div>
<script>
createPagingToolbar('frm', $!form.pager.start, $!form.pager.limit, $!form.pager.totalCount);
</script>
</form>
<div id='orgtypeDiv' style="display:none;">
	<form id='frm2'>
    	<input type='hidden' id='headid'>
        <table class="control">
        	<tr>
    			<td>
    				<input type='button' value='增行' onclick="selectStyle()">
    				<input type='button' value='保存' onclick="saveDisplayStandard()" $RightUtil.able($session, '08091202','1')>
    				<input type='button' value='取消' onclick="jQuery('#orgtypeDiv').dialog('close');">
    			</td>
    		</tr>
        </table>
    	<table class='content'>
    		<tr>
                <td class='body1'>组织类别</td>
                <td class='body2'><input id='orgtypeName' readonly/></td>
			</tr>
			<tr>
                <td class='body1'>大类</td>
                <td class='body2'><select id='itemClassId' onchange="changeOrnaClassId()">$!StringUtil.emptyOption()</select></td>
                <td class='body1'>小类</td>
                <td class='body2'><select id='ornaClassId' onchange="changeOrnaClass()">$!StringUtil.emptyOption()</select></td>
			</tr>
			<tr>
                <td class='body1'>分析范围</td>
                <td class='body2'><select id='analysisId'>$!StringUtil.emptyOption()</select></td>
                <td class='body1'>款式大类</td>
                <td class='body2'><select id='styleItemClassId'>$!StringUtil.emptyOption()</select></td>
			</tr>
        </table>
        <table class='list'>
        	<thead>
    			<tr>
                    <th width='45px'></th>
					<th width='120px'>大类</th>
            		<th width='120px'>小类</th>
            		<th width='120px'>分析范围</th>
            		<th width='120px'>款式大类</th>
            		<th width='120px'>款式中类</th>
            		<th width='150px'>款式小类</th>
            		<th width='120px'>款式</th>
            		<th width='120px'>最小量</th>
            		<th width='120px'>最大量</th>
            		<th></th>
                </tr>
            </thead>
            <tbody id="tbl2"></tbody>
        </table>
	</form>
</div>
<div id='selectStyleDiv' title="选择款式" style="display:none;">
	<table class='list'>
    	<thead>
			<tr>
                <th width='60px'><input type='checkbox' id='selectStyleChkAll'></th>
                <th width='120px'>款式中类</th>
                <th width='120px'>款式小类</th>
                <th width='120px'>款式名称</th>
                <th width='120px'>上一年销量</th>
                <th width='120px'>上半年销量</th>
                <th width='120px'>上一月销量</th>
			</tr>
        </thead>
		<tbody id='selectStyleTbl'></tbody>
    </table>
	<table style='width:100%;'><tr><td style='BACKGROUND-COLOR: #D2E0F1;height:20px;' valign='center' id='selectStylePagingTd'>
	</td></tr></table>
</div>
<script>
var refreshFlag = false;
jQuery(function(){
	checkTable('tbl', 'chkall', 'chk', true, null, function(index){
		showEidtDialog(index);
	});
	initQuery2('PDISPLAYSTANDARD01', "frm", 'btnQueryShow');
	checkAll('selectStyleChkAll','selectStyleChk',true);
	resetWinSize();
});
function exportListToExcel(){
	jQuery("#user_action").val("exportExcel");
	jQuery("#frm").submit();
	jQuery("#user_action").val("");
}
function createPagingToolbar2(callbackFunc, start, limit, totalCount){
	var html = "<input type='hidden' id='_js_start' value=''/>";
	html += "<input type='hidden' id='_js_limit' value=''/>";
	html += "<input type='hidden' id='_js_totalCount' value=''/>";
	html += "<input type='image' id='_js_btnFirst'   src='" + ctxPath + "/css/mclon/img/page-first.gif' style='vertical-align:text-bottom;' title='第一页'>&nbsp;";
	html += "<input type='image' id='_js_btnPre'     src='" + ctxPath + "/css/mclon/img/page-prev.gif'  style='vertical-align:text-bottom;' title='上一页'>&nbsp;";
	html += "当前第<input type='text' id='_js_pageindex' style='width:25px;height:12px;text-align:center;' value=''>页&nbsp;";
	html += "共<input type='text' id='_js_totalPageCount' style='width:40px;height:12px;text-align:center;background-color:#EBEBEB;' value='' readonly>页&nbsp;";
	html += "<input type='image' id='_js_btnNext'    src='" + ctxPath + "/css/mclon/img/page-next.gif'  style='vertical-align:text-bottom;' title='下一页'>&nbsp;";
	html += "<input type='image' id='_js_btnLast'    src='" + ctxPath + "/css/mclon/img/page-last.gif'  style='vertical-align:text-bottom;' title='最后页'>&nbsp;";
	html += "<input type='image' id='_js_btnRefresh' src='" + ctxPath + "/css/mclon/img/refresh.gif'    style='vertical-align:text-bottom;' title='刷新'>&nbsp;";
	
	html += "每页<input type='text' id='_js_pageCount' style='width:25px;height:12px;text-align:center;' value=''>条&nbsp;";
	html += "显示第 "+start+" 条到 "+(start + limit - 1)+" 条记录，一共 "+totalCount+" 条";
	jQuery("#selectStylePagingTd").html(html);
	
	jQuery("#_js_start").val(start);
	jQuery("#_js_limit").val(limit);
	jQuery("#_js_pageindex").val(Math.ceil(start / limit));
	jQuery("#_js_totalPageCount").val(Math.ceil(totalCount / limit));
	jQuery("#_js_pageCount").val(limit);
	jQuery("#_js_totalCount").val(totalCount);
	
	if(parseInt(jQuery("#_js_pageindex").val())<=1){
		jQuery("#_js_btnPre").attr('src', "" + ctxPath + "/css/mclon/img/page-prev-disabled.gif");
		jQuery("#_js_btnFirst").attr("src", "" + ctxPath + "/css/mclon/img/page-first-disabled.gif");
		
		jQuery("#_js_btnPre").attr('disabled', true);
		jQuery("#_js_btnFirst").attr("disabled", true);
	}
	if(parseInt(jQuery("#_js_pageindex").val())>=parseInt(jQuery("#_js_totalPageCount").val())){
		jQuery("#_js_btnNext").attr('src', ctxPath + "/css/mclon/img/page-next-disabled.gif");
		jQuery("#_js_btnLast").attr("src", ctxPath + "/css/mclon/img/page-last-disabled.gif");
		
		jQuery("#_js_btnNext").attr('disabled', true);
		jQuery("#_js_btnLast").attr("disabled", true);
	}
	/**
	* 改变页数
	*/
	jQuery("#_js_pageindex").change(function(){
		if(isNumeric(jQuery("#_js_pageindex").val())){
	       	jQuery("#_js_start").val((parseInt(jQuery("#_js_pageindex").val()) - 1) * parseInt(jQuery("#_js_pageCount").val()) + 1);
			callbackFunc(jQuery("#_js_start").val(), jQuery("#_js_limit").val());
		}else{
			jQuery("#_js_pageindex").val("");
		}
		
	});
	/**
	* 改变每页显示条数
	*/
	jQuery("#_js_pageCount").change(function(){
		if(isNumeric(jQuery("#_js_pageCount").val())){
	    	jQuery("#_js_start").val("1");
	    	jQuery("#_js_limit").val(jQuery("#_js_pageCount").val());
			callbackFunc(jQuery("#_js_start").val(), jQuery("#_js_limit").val());
		}else{
			jQuery("#_js_pageCount").val("");
		}
	});
	jQuery("#_js_totalPageCount").focus(function(){
		jQuery(this).blur();
	});
	jQuery("#_js_btnFirst").click(function(){
		jQuery("#_js_start").val("1");
		callbackFunc(jQuery("#_js_start").val(), jQuery("#_js_limit").val());
	});
	jQuery("#_js_btnPre").click(function(){
		if(parseInt(jQuery("#_js_start").val()) - parseInt(jQuery("#_js_limit").val()) - 1 >= 0){
			jQuery("#_js_start").val(parseInt(jQuery("#_js_start").val()) - parseInt(jQuery("#_js_limit").val()));
			callbackFunc(jQuery("#_js_start").val(), jQuery("#_js_limit").val());
		}
	});
	jQuery("#_js_btnLast").click(function(){
		jQuery("#_js_start").val((Math.ceil(totalCount / limit)-1)*parseInt(jQuery("#_js_pageCount").val()) + 1);
		callbackFunc(jQuery("#_js_start").val(), jQuery("#_js_limit").val());
	});
	jQuery("#_js_btnNext").click(function(){
		if(parseInt(jQuery("#_js_start").val()) + parseInt(jQuery("#_js_limit").val()) - 1 <= totalCount){
	    	//jQuery("#_js_pageindex").val(parseInt(jQuery("#_js_pageindex").val()) + 1);
	    	jQuery("#_js_start").val(parseInt(jQuery("#_js_start").val()) + parseInt(jQuery("#_js_limit").val()));
			callbackFunc(jQuery("#_js_start").val(), jQuery("#_js_limit").val());
		}
	});
	jQuery("#_js_btnRefresh").click(function(){
		callbackFunc(jQuery("#_js_start").val(), jQuery("#_js_limit").val());
	});
}
</script>